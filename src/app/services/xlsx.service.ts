import { Injectable } from '@angular/core';
import { read, utils, writeFile } from 'xlsx-js-style';
import { RapportoCommesse } from '../models/rapporto-commesse';
import { RapportoMensile } from '../models/rapporto-mensile';
import { RapportoPresenze } from '../models/rapporto-presenze';

@Injectable({
  providedIn: 'root',
})
export class XlsxService {
  constructor() { }
  public generateRapportoPresenze() {
    new RapportoPresenze("Angelica Zenere", "SCAI ITEC", this.data).generate();
  }

  public generateRapportoCommesse(user, azienda, data) {
    new RapportoCommesse("Angelica Zenere", "SCAI ITEC", data).generate();
  }

  public generateRapportoMensile() {
    new RapportoMensile("Angelica Zenere", "SCAI ITEC", this.data).generate();
  }

  data = {
    inizio: '2022-10-31',
    fine: '2022-11-06',
    statoChiusura: 2,
    giorni: [
      {
        statoChiusura: 3,
        dataPresenza: '2022-11-10',
        progressivo: 1,
        numeroMinuti: 480,
        reperibilita: false,
        turni: false,
        note: null,
        start: null,
        end: null,
        idAttivita: 322,
        codiceAttivita: 'Ferie',
        idCommessa: 266,
        codiceCommessa: 'Ferie',
        modificabile: true,
        modalitaLavoro: null,
        presenzeOrario: null,
        straordinari: [],
        trasferta: null,
      },
      {
        statoChiusura: 2,
        dataPresenza: '2022-11-02',
        progressivo: 1,
        numeroMinuti: 120,
        reperibilita: false,
        turni: false,
        note: null,
        start: '2022-11-02T15:00:00',
        end: '2022-11-02T17:00:00',
        idAttivita: 4462,
        codiceAttivita: '29_15-ITE-XXX',
        idCommessa: 2154,
        codiceCommessa: '29_15-ITE-XXX',
        modificabile: true,
        modalitaLavoro: null,
        presenzeOrario: {
          idAttivita: 4462,
          dataPresenza: '2022-11-02',
          idUtente: 2383,
          idAzienda: 9,
          progressivo: 1,
          start: '2022-11-02T15:00:00',
          end: '2022-11-02T17:00:00',
          datiPresenze: null,
        },
        straordinari: [
          {
            progressivo: 1,
            numeroMinuti: 0,
            idTipoStraordinari: 1,
            tipoStraordinariDescrizione: 'Straordinario',
          },
        ],
        trasferta: null,
      },
      {
        statoChiusura: 2,
        dataPresenza: '2022-11-02',
        progressivo: 1,
        numeroMinuti: 420,
        reperibilita: false,
        turni: false,
        note: null,
        start: '2022-11-02T01:00:00',
        end: '2022-11-02T08:00:00',
        idAttivita: 12265,
        codiceAttivita: '22_15-ITE-XXX',
        idCommessa: 7644,
        codiceCommessa: '22_15-ITE-XXX',
        modificabile: true,
        modalitaLavoro: null,
        presenzeOrario: {
          idAttivita: 12265,
          dataPresenza: '2022-11-02',
          idUtente: 2383,
          idAzienda: 9,
          progressivo: 1,
          start: '2022-11-02T01:00:00',
          end: '2022-11-02T08:00:00',
          datiPresenze: null,
        },
        straordinari: [],
        trasferta: null,
      },
      {
        statoChiusura: 2,
        dataPresenza: '2022-11-02',
        progressivo: 1,
        numeroMinuti: 180,
        reperibilita: false,
        turni: false,
        note: null,
        start: '2022-11-02T08:00:00',
        end: '2022-11-02T11:00:00',
        idAttivita: 41434,
        codiceAttivita: '2842_BET22-000162',
        idCommessa: 46152,
        codiceCommessa: '2842_BET22-000162',
        modificabile: true,
        modalitaLavoro: null,
        presenzeOrario: {
          idAttivita: 41434,
          dataPresenza: '2022-11-02',
          idUtente: 2383,
          idAzienda: 9,
          progressivo: 1,
          start: '2022-11-02T08:00:00',
          end: '2022-11-02T11:00:00',
          datiPresenze: null,
        },
        straordinari: [],
        trasferta: null,
      },
      {
        statoChiusura: 2,
        dataPresenza: '2022-11-02',
        progressivo: 1,
        numeroMinuti: 180,
        reperibilita: false,
        turni: false,
        note: null,
        start: '2022-11-02T12:00:00',
        end: '2022-11-02T15:00:00',
        idAttivita: 42131,
        codiceAttivita: '2865_SCA22-XXXXXX',
        idCommessa: 47208,
        codiceCommessa: '2865_SCA22-XXXXXX',
        modificabile: true,
        modalitaLavoro: null,
        presenzeOrario: {
          idAttivita: 42131,
          dataPresenza: '2022-11-02',
          idUtente: 2383,
          idAzienda: 9,
          progressivo: 1,
          start: '2022-11-02T12:00:00',
          end: '2022-11-02T15:00:00',
          datiPresenze: null,
        },
        straordinari: [],
        trasferta: null,
      },
      {
        statoChiusura: 2,
        dataPresenza: '2022-11-03',
        progressivo: 1,
        numeroMinuti: 210,
        reperibilita: false,
        turni: false,
        note: null,
        start: '2022-11-03T12:30:00',
        end: '2022-11-03T16:00:00',
        idAttivita: 4460,
        codiceAttivita: '27_15-ITE-XXX',
        idCommessa: 2152,
        codiceCommessa: '27_15-ITE-XXX',
        modificabile: true,
        modalitaLavoro: null,
        presenzeOrario: {
          idAttivita: 4460,
          dataPresenza: '2022-11-03',
          idUtente: 2383,
          idAzienda: 9,
          progressivo: 1,
          start: '2022-11-03T12:30:00',
          end: '2022-11-03T16:00:00',
          datiPresenze: null,
        },
        straordinari: [],
        trasferta: null,
      },
      {
        statoChiusura: 2,
        dataPresenza: '2022-11-03',
        progressivo: 1,
        numeroMinuti: 420,
        reperibilita: false,
        turni: false,
        note: null,
        start: '2022-11-03T01:00:00',
        end: '2022-11-03T08:00:00',
        idAttivita: 38133,
        codiceAttivita: '2661_ETT21-XXXXXX',
        idCommessa: 42085,
        codiceCommessa: '2661_ETT21-XXXXXX',
        modificabile: true,
        modalitaLavoro: null,
        presenzeOrario: {
          idAttivita: 38133,
          dataPresenza: '2022-11-03',
          idUtente: 2383,
          idAzienda: 9,
          progressivo: 1,
          start: '2022-11-03T01:00:00',
          end: '2022-11-03T08:00:00',
          datiPresenze: null,
        },
        straordinari: [],
        trasferta: null,
      },
      {
        statoChiusura: 2,
        dataPresenza: '2022-11-03',
        progressivo: 1,
        numeroMinuti: 90,
        reperibilita: false,
        turni: false,
        note: null,
        start: '2022-11-03T08:00:00',
        end: '2022-11-03T09:30:00',
        idAttivita: 41434,
        codiceAttivita: '2842_BET22-000162',
        idCommessa: 46152,
        codiceCommessa: '2842_BET22-000162',
        modificabile: true,
        modalitaLavoro: null,
        presenzeOrario: {
          idAttivita: 41434,
          dataPresenza: '2022-11-03',
          idUtente: 2383,
          idAzienda: 9,
          progressivo: 1,
          start: '2022-11-03T08:00:00',
          end: '2022-11-03T09:30:00',
          datiPresenze: null,
        },
        straordinari: [
          {
            progressivo: 1,
            numeroMinuti: 0,
            idTipoStraordinari: 1,
            tipoStraordinariDescrizione: 'Straordinario',
          },
        ],
        trasferta: null,
      },
      {
        statoChiusura: 2,
        dataPresenza: '2022-11-03',
        progressivo: 1,
        numeroMinuti: 120,
        reperibilita: false,
        turni: false,
        note: null,
        start: '2022-11-03T09:30:00',
        end: '2022-11-03T11:30:00',
        idAttivita: 42131,
        codiceAttivita: '2865_SCA22-XXXXXX',
        idCommessa: 47208,
        codiceCommessa: '2865_SCA22-XXXXXX',
        modificabile: true,
        modalitaLavoro: null,
        presenzeOrario: {
          idAttivita: 42131,
          dataPresenza: '2022-11-03',
          idUtente: 2383,
          idAzienda: 9,
          progressivo: 1,
          start: '2022-11-03T09:30:00',
          end: '2022-11-03T11:30:00',
          datiPresenze: null,
        },
        straordinari: [],
        trasferta: null,
      },
      {
        statoChiusura: 2,
        dataPresenza: '2022-11-03',
        progressivo: 2,
        numeroMinuti: 60,
        reperibilita: false,
        turni: false,
        note: null,
        start: '2022-11-03T16:00:00',
        end: '2022-11-03T17:00:00',
        idAttivita: 42131,
        codiceAttivita: '2865_SCA22-XXXXXX',
        idCommessa: 47208,
        codiceCommessa: '2865_SCA22-XXXXXX',
        modificabile: true,
        modalitaLavoro: null,
        presenzeOrario: {
          idAttivita: 42131,
          dataPresenza: '2022-11-03',
          idUtente: 2383,
          idAzienda: 9,
          progressivo: 2,
          start: '2022-11-03T16:00:00',
          end: '2022-11-03T17:00:00',
          datiPresenze: null,
        },
        straordinari: [
          {
            progressivo: 2,
            numeroMinuti: 0,
            idTipoStraordinari: 1,
            tipoStraordinariDescrizione: 'Straordinario',
          },
        ],
        trasferta: null,
      },
      {
        statoChiusura: 2,
        dataPresenza: '2022-11-04',
        progressivo: 1,
        numeroMinuti: 180,
        reperibilita: false,
        turni: false,
        note: null,
        start: '2022-11-04T13:00:00',
        end: '2022-11-04T16:00:00',
        idAttivita: 4460,
        codiceAttivita: '27_15-ITE-XXX',
        idCommessa: 2152,
        codiceCommessa: '27_15-ITE-XXX',
        modificabile: true,
        modalitaLavoro: null,
        presenzeOrario: {
          idAttivita: 4460,
          dataPresenza: '2022-11-04',
          idUtente: 2383,
          idAzienda: 9,
          progressivo: 1,
          start: '2022-11-04T13:00:00',
          end: '2022-11-04T16:00:00',
          datiPresenze: null,
        },
        straordinari: [],
        trasferta: null,
      },
      {
        statoChiusura: 2,
        dataPresenza: '2022-11-04',
        progressivo: 1,
        numeroMinuti: 60,
        reperibilita: false,
        turni: false,
        note: null,
        start: '2022-11-04T16:00:00',
        end: '2022-11-04T17:00:00',
        idAttivita: 4462,
        codiceAttivita: '29_15-ITE-XXX',
        idCommessa: 2154,
        codiceCommessa: '29_15-ITE-XXX',
        modificabile: true,
        modalitaLavoro: null,
        presenzeOrario: {
          idAttivita: 4462,
          dataPresenza: '2022-11-04',
          idUtente: 2383,
          idAzienda: 9,
          progressivo: 1,
          start: '2022-11-04T16:00:00',
          end: '2022-11-04T17:00:00',
          datiPresenze: null,
        },
        straordinari: [],
        trasferta: null,
      },
      {
        statoChiusura: 2,
        dataPresenza: '2022-11-04',
        progressivo: 1,
        numeroMinuti: 480,
        reperibilita: false,
        turni: false,
        note: null,
        start: '2022-11-04T00:00:00',
        end: '2022-11-04T08:00:00',
        idAttivita: 38133,
        codiceAttivita: '2661_ETT21-XXXXXX',
        idCommessa: 42085,
        codiceCommessa: '2661_ETT21-XXXXXX',
        modificabile: true,
        modalitaLavoro: null,
        presenzeOrario: {
          idAttivita: 38133,
          dataPresenza: '2022-11-04',
          idUtente: 2383,
          idAzienda: 9,
          progressivo: 1,
          start: '2022-11-04T00:00:00',
          end: '2022-11-04T08:00:00',
          datiPresenze: null,
        },
        straordinari: [],
        trasferta: null,
      },
      {
        statoChiusura: 2,
        dataPresenza: '2022-11-04',
        progressivo: 1,
        numeroMinuti: 240,
        reperibilita: false,
        turni: false,
        note: null,
        start: '2022-11-04T08:00:00',
        end: '2022-11-04T12:00:00',
        idAttivita: 42131,
        codiceAttivita: '2865_SCA22-XXXXXX',
        idCommessa: 47208,
        codiceCommessa: '2865_SCA22-XXXXXX',
        modificabile: true,
        modalitaLavoro: null,
        presenzeOrario: {
          idAttivita: 42131,
          dataPresenza: '2022-11-04',
          idUtente: 2383,
          idAzienda: 9,
          progressivo: 1,
          start: '2022-11-04T08:00:00',
          end: '2022-11-04T12:00:00',
          datiPresenze: null,
        },
        straordinari: [],
        trasferta: null,
      },
    ],
  };
}
